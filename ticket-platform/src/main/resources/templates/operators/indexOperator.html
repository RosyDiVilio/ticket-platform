<!DOCTYPE html>
<html lang="en">
<head th:insert="~{fragments/fragments :: head}">
  
</head>
<body>
	<header th:insert="~{fragments/navbarUser :: navbarUser(tickets)}"></header>
	
	<div class="container">
		<div class="row">
			<div class="col">
				<th:block th:if="${tickets.size() > 0}">
					
				    <h1 class="mb-5 mt-4 text-center">Lista dei tickets assegnati</h1>
					
					<th:block th:if="${errorMessage != null}">
						<div th:replace="~{fragments/fragments :: errorAlert(${errorMessage})}"></div>
					</th:block>
					
					<div class="mb-4">
						<span class="text-uppercase fw-bold" th:text="'Stato operatore: ' + ${status}"></span> <a th:href="@{operators/editStatusUser/{id}(id=${userId})}" 
						class="btn btn-primary" style="float: right;">Modifica Stato</a> 
					</div>
					
					<table class="table table-hover">
					  <thead>
						<tr>
						  <th scope="col">ID</th>
						  <th scope="col">Titolo</th>
						  <th scope="col">Descrizione</th>
						  <th scope="col">Stato</th>
						  <th scope="col">Data Richiesta</th>
						  <th scope="col">Data Ultima Modifica</th>
						  <th></th>
						  <th></th>
						  <th></th>
						</tr>
					  </thead>
					  <tbody>
						<tr th:each="ticket : ${tickets}">
						  <td th:text="${ticket.id}"></td>
						  <td th:text="${ticket.title}"></td>
						  <td th:text="${ticket.description}"></td>
						  <td th:text="${ticket.status}" class="text-uppercase fw-medium"></td>
						  <td th:text="${ticket.getFormattedCreatedAt()}"></td>
						  <td th:text="${ticket.getFormattedUpdatedAt()}"></td>
						  <td>
							<a th:href="@{/tickets/{id}(id=${ticket.id})}" class="btn btn-primary">Dettagli</a>
						  </td>
						  <td>
							<a th:href="@{/operators/editStatusTicket/{id}(id=${ticket.id})}" class="btn btn-primary">Modifica ticket</a>
						  </td>
						  <td>
							<a th:href="@{/notes/createNote/{ticketId}(ticketId=${ticket.id})}" class="btn btn-primary mb-4">Crea nota</a>
						  </td>
						</tr>
					  </tbody>
					</table>
				</th:block>

				<th:block th:unless="${tickets.size() > 0}">
				    <h3 class="my-5 text-center">Non ci sono tickets assegnati</h3>
				</th:block>
			
			</div>
        </div>
    </div>
	
	<th:block th:replace="~{fragments/fragments :: scripts}"></th:block>
</body>
</html>